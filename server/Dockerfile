FROM node:20

WORKDIR /app
COPY package*.json ./
RUN npm install

ARG SPOONACULAR_BASE_API
ARG SPOONACULAR_APIKEY
ARG DB_CONNECTION_STRING
ARG CLERK_PUBLISHABLE_KEY
ARG CLERK_SECRET_KEY
ARG SESSION_NAME
ARG SESSION_SECRET

#Sets argument variables to environment variables
ENV SESSION_NAME=$SESSION_NAME
ENV SESSION_SECRET=$SESSION_SECRET
ENV SPOONACULAR_BASE_API=$SPOONACULAR_BASE_API
ENV SPOONACULAR_APIKEY=$SPOONACULAR_APIKEY
ENV DB_CONNECTION_STRING=$DB_CONNECTION_STRING
ENV CLERK_SECRET_KEY=$CLERK_SECRET_KEY
ENV CLERK_PUBLISHABLE_KEY =$CLERK_PUBLISHABLE_KEY
ENV NODE_ENV=production
COPY . .

EXPOSE 3000
CMD ["npm", "start"]